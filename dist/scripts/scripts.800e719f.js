"use strict";angular.module("karmaApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$httpProvider",function(a){a.defaults.useXDomain=!0,a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",a.defaults.headers.common.Accept="application/json, text/plain, * / *",a.defaults.headers.get={Authorization:"Basic QWFyb246bWFuYWdl"},a.defaults.headers.options={Authorization:"Basic QWFyb246bWFuYWdl"},a.defaults.withCredentials=!0}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("karmaApp").controller("MainCtrl",["$scope","Driver","Greeting",function(a,b,c){a.greeting2={id:"xxx",content:"Hello World!"},a.driver=b.get(),a.greeting=c.get(function(a){console.log(a)})}]),angular.module("karmaApp").controller("LoginCtrl",["$scope","$rootScope","$location","$http","User","UserAuth",function(a,b,c,d,e,f){a.authenticate=function(a,c){var e={Authorization:"Basic QWFyb246bWFuYWdl",Accept:"application/json"};console.log(e),d.get("http://localhost:8080/api/resource",{headers:e}).success(function(a){a.name?(b.authenticated=!0,console.log(a)):(b.authenticated=!1,console.log(a)),c&&c()}).error(function(){b.authenticated=!1,c&&c()})},a.authenticate(),a.credentials={},a.login=function(){console.log("logging in"),a.authenticate(a.credentials,function(){b.authenticated?(c.path("/"),a.error=!1):(c.path("/login"),a.error=!0)})},a.logout=function(){d.post("logout",{})["finally"](function(){b.authenticated=!1,c.path("/")})}}]),angular.module("karmaApp").factory("Driver",["$resource",function(a){var b=a("http://thor.bigcompass.com:3456/api/driver",{post:{method:"POST"},get:{method:"GET"},update:{method:"PUT"},query:{method:"GET",isArray:!1}});return b}]),angular.module("karmaApp").factory("Greeting",["$resource",function(a){var b=a("http://localhost:8080/api/greeting",{post:{method:"POST"},get:{method:"GET"},update:{method:"PUT"},query:{method:"GET",isArray:!1}});return b}]),angular.module("karmaApp").factory("User",["$resource",function(a){var b=a("http://localhost:8080/api/user",{post:{method:"POST"},get:{method:"GET"},update:{method:"PUT"},query:{method:"GET",isArray:!1}});return b}]),angular.module("karmaApp").factory("UserAuth",["$resource","$http",function(a,b){return{setCredentials:function(a,c){var d=btoa(a+":"+c);console.log(b.defaults),b.defaults.headers.common.Authorization="Basic "+d},getCredentials:function(){},clearCredentials:function(){b.defaults.headers.common.Authorization="Basic "},jokes:function(){return a("http://localhost:8080/api/user",null,{query:{method:"GET",headers:{Authorization:"Bearer myToken"}}})}}}]),angular.module("karmaApp").run(["$templateCache",function(a){a.put("views/login.html",'<div class="alert alert-danger" ng-show="error"> There was a problem logging in. Please try again. </div> <form role="form" ng-submit="login()"> <div class="form-group"> <label for="username">Username:</label> <input type="text" class="form-control" id="username" name="username" ng-model="credentials.username"> </div> <div class="form-group"> <label for="password">Password:</label> <input type="password" class="form-control" id="password" name="password" ng-model="credentials.password"> </div> <button type="submit" class="btn btn-primary">Submit</button> </form> {{credentials}}'),a.put("views/main.html",'<div class="row"> <h2>The Driver Is a driver:</h2> <p>{{driver}}</p> </div> <h1>Greeting</h1> <div ng-show="authenticated"> <p>The ID is {{greeting.id}}</p> <p>The content is {{greeting.content}}</p> </div> <div ng-show="!authenticated"> <p>Login to see your greeting</p> </div>')}]);